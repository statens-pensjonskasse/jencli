@Library('jenkins-pipeline-library@latest_develop')
import no.spk.jenkins.pipeline.ci.config.CIPipelineConfig

String BUILD_IMAGE='old-dockerhub.spk.no:5000/jenkins-agent-docker/master'

ciPipeline {
    config = CIPipelineConfig
            .getTrunkBasedConfig(trunk: 'main')
            .useMake(
                buildImage: BUILD_IMAGE,
                build: 'build-ci',
                test: 'test-ci',
                buildContainerArgs: '-e DOCKER_HOST=${DOCKER_HOST}')
            .withSonarQube()
            .withSlackNotifications(channels: 'applikasjonsplattform-ci')
            .withLog(level: 'all')
}